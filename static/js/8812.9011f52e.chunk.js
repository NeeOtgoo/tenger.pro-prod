"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[8812],{74021:function(e,t,n){var i=n(29439),r=n(72791),s=n(66871),a=n(49389),o=n(87309),l=n(59432),d=n(11730),c=n(31549),u=n(82630),f=n(68470),m=n(80184);t.Z=function(e){var t=e.fetchData,n=e.loading,x=e.columns,Z=e.data,v=e.permissions,p=e.showModal,h=(0,r.useState)(""),j=(0,i.Z)(h,2),$=(j[0],j[1]);return(0,m.jsxs)(s.Z,{children:[(0,m.jsxs)(f.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:[(0,m.jsx)(f.Z,{className:"mb-1",mobileFlex:!1,children:(0,m.jsx)("div",{className:"mr-md-3 mb-3",children:(0,m.jsx)(a.Z,{placeholder:"\u0425\u0430\u0439\u0445",prefix:(0,m.jsx)(d.Z,{}),onChange:function(e){return function(e){var n=e.currentTarget.value;t({variables:{offset:0,limit:1e7,filter:n,program:0}}),$(n)}(e)}})})}),!0===v.create&&(0,m.jsx)("div",{className:"mr-md-3 mb-3",children:(0,m.jsxs)(o.Z,{onClick:p,type:"primary",icon:(0,m.jsx)(c.Z,{}),block:!0,children:[" ",(0,m.jsx)(u.Z,{id:"add_new"})]})})]}),(0,m.jsx)("div",{className:"table-responsive",children:(0,m.jsx)(l.Z,{size:"small",columns:x,dataSource:Z,rowKey:"id",bordered:!0,loading:n})})]})}},68470:function(e,t,n){n(72791);var i=n(80184),r=function(e){var t=e.children,n=e.className,r=e.alignItems,s=e.justifyContent,a=e.mobileFlex,o=e.flexDirection;return(0,i.jsx)("div",{className:"".concat(a?"d-flex":"d-md-flex"," ").concat(n," ").concat(o?"flex-"+o:""," ").concat(r?"align-items-"+r:""," ").concat(s?"justify-content-"+s:""),children:t})};r.defaultProps={mobileFlex:!0,flexDirection:"row",className:""},t.Z=r},21708:function(e,t,n){n.d(t,{FP:function(){return u},Pg:function(){return c},fc:function(){return x},l7:function(){return f},rT:function(){return m}});var i,r,s,a,o,l=n(30168),d=n(27570),c=(0,d.Ps)(i||(i=(0,l.Z)(['\n    query allLives ($offset: Int!, $limit: Int!, $filter: String) {\n        count (appName: "live", modelName: "Live", filter: $filter) {\n            count\n        }\n        allLives (offset: $offset, limit: $limit, filter: $filter) {\n            id\n            title\n            date\n            duration\n            description\n            status\n            type\n            section {\n                id\n                section\n            }\n            password\n            teacher {\n                id\n                name\n            }\n            password\n        }\n    }\n']))),u=(0,d.Ps)(r||(r=(0,l.Z)(["\n    mutation createLive ($date: String, $description: String, $duration: Int, $status: String, $teacher: Int, $title: String, $section: Int) {\n        createLive (date: $date, description: $description, duration: $duration, status: $status, teacher: $teacher, title: $title, section: $section) {\n            live {\n                id\n            }\n        }\n    }\n"]))),f=(0,d.Ps)(s||(s=(0,l.Z)(["\n    mutation updateLive ($date: String, $description: String, $duration: Int, $id: ID, $status: String, $teacher: Int, $title: String, $section: Int) {\n        updateLive (date: $date, description: $description, duration: $duration, id: $id, status: $status, teacher: $teacher, title: $title, section: $section) {\n            live {\n                id\n            }\n        }\n    }\n"]))),m=(0,d.Ps)(a||(a=(0,l.Z)(["\n    mutation deleteLive ($id: ID) {\n        deleteLive (id: $id) {\n            live {\n                title\n            }\n        }\n    }\n"]))),x=(0,d.Ps)(o||(o=(0,l.Z)(["\n    query getLiveurl ($liveId: Int) {\n        getLiveurl (liveId: $liveId) {\n            url\n        }\n    }\n"])))},48812:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=n(72791),r=n(29439),s=n(20003),a=n(50419),o=n(87309),l=n(77154),d=n(36795),c=n(82464),u=n(2703),f=n(86586),m=n(84376),x=n(82630),Z=n(21708),v=n(72426),p=n.n(v),h=n(74021),j=n(38937),$=n(80184),y=(0,i.lazy)((function(){return Promise.all([n.e(3332),n.e(1561),n.e(6835),n.e(7320)]).then(n.bind(n,17320))})),b=function(e){var t=(0,i.useState)([]),n=(0,r.Z)(t,2),v=n[0],b=n[1],g=(0,i.useState)(0),k=(0,r.Z)(g,2),I=k[0],S=k[1],w=(0,f.t)(Z.Pg,{fetchPolicy:"network-only",onCompleted:function(e){S(e.count.count),b(e.allLives)}}),T=(0,r.Z)(w,2),P=T[0],C=T[1],L=C.loading,D=C.refetch,N=(0,f.t)(Z.fc,{fetchPolicy:"network-only",onCompleted:function(e){window.open(e.getLiveurl.url,"_blank")}}),F=(0,r.Z)(N,1)[0];(0,i.useEffect)((function(){P({variables:{offset:0,limit:10,filter:""}})}),[P]);var M=(0,i.useState)(!1),_=(0,r.Z)(M,2),z=_[0],Y=_[1],O=(0,i.useState)([]),q=(0,r.Z)(O,2),H=q[0],B=q[1],E=(0,i.useState)(""),K=(0,r.Z)(E,2),R=K[0],V=K[1],A=s.Z.confirm,G=(0,m.D)(Z.rT,{onCompleted:function(e){a.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0443\u0441\u0442\u043b\u0430\u0430"),D()}}),J=(0,r.Z)(G,1)[0];var Q=[{key:"title",title:(0,$.jsx)(x.Z,{id:"title"}),dataIndex:"title",sorter:function(e,t){return u.ZP.antdTableSorter(e,t,"title")}},{key:"type",title:(0,$.jsx)(x.Z,{id:"onlineType"}),dataIndex:"type",sorter:function(e,t){return u.ZP.antdTableSorter(e,t,"type")},render:function(e){return(0,$.jsx)(x.Z,{id:e})}},{key:"teacher",title:(0,$.jsx)(x.Z,{id:"teacher"}),dataIndex:["teacher","name"],sorter:function(e,t){return u.ZP.antdTableSorter(e,t,"teacher")}},{key:"date",title:(0,$.jsx)(x.Z,{id:"date"}),dataIndex:"date",sorter:function(e,t){return u.ZP.antdTableSorter(e,t,"date")},render:function(e){return(0,$.jsx)("span",{children:p()(e).format("YYYY-MM-DD HH:mm")})}},{key:"duration",title:(0,$.jsx)(x.Z,{id:"duration"}),dataIndex:"duration",sorter:function(e,t){return u.ZP.antdTableSorter(e,t,"duration")}},{key:"actions",title:(0,$.jsx)(x.Z,{id:"main.action"}),width:"20vw",dataIndex:"actions",render:function(t,n){return(0,$.jsxs)("div",{className:"text-center",children:[(0,$.jsxs)(o.Z,{size:"small",type:"text",icon:(0,$.jsx)(l.Z,{}),onClick:function(){F({variables:{liveId:n.id}})},children:[" ",(0,$.jsx)(x.Z,{id:"show"})," "]}),!0===e.permissions.edit&&(0,$.jsxs)(o.Z,{size:"small",onClick:function(){return B(n),V("edit"),void Y(!0)},type:"text",icon:(0,$.jsx)(d.Z,{twoToneColor:"#ffdb00"}),children:[" ",(0,$.jsx)(x.Z,{id:"edit"})," "]}),!0===e.permissions.destroy&&(0,$.jsxs)(o.Z,{size:"small",onClick:function(){return e=n,void A({title:"\u0423\u0441\u0442\u0433\u0430\u0445 \u0443\u0443?",okText:"\u0423\u0441\u0442\u0433\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){J({variables:{id:e.id,name:e.name,nameMgl:e.nameMgl}})}});var e},type:"text",icon:(0,$.jsx)(c.Z,{twoToneColor:"#f42f2f"}),children:[" ",(0,$.jsx)(x.Z,{id:"delete"})]})]})}}];return(0,$.jsxs)($.Fragment,{children:[e.permissions.edit||e.permissions.create?(0,$.jsx)(s.Z,{width:"80vw",forceRender:!0,title:"edit"===R?(0,$.jsx)(x.Z,{id:"edit"}):(0,$.jsx)(x.Z,{id:"add_new"}),visible:z,okText:(0,$.jsx)(x.Z,{id:"main.okText"}),cancelText:(0,$.jsx)(x.Z,{id:"main.cancelText"}),onCancel:function(){Y(!1)},okButtonProps:{form:"SchoolForm",key:"submit",htmlType:"submit"},children:(0,$.jsx)(i.Suspense,{fallback:(0,$.jsx)(j.Z,{cover:"content"}),children:(0,$.jsx)(y,{formType:R,setIsModalVisible:Y,refetch:D,editData:H})})}):null,(0,$.jsx)(h.Z,{fetchData:P,loading:L,columns:Q,data:v,count:I,permissions:e.permissions,showModal:function(){V("create"),Y(!0)}})]})},g=n(59288),k=function(e){var t={create:(0,g.C)("add_live"),edit:(0,g.C)("change_live"),destroy:(0,g.C)("delete_live")};return Object.values(t).indexOf("loading")>-1?(0,$.jsx)(j.Z,{cover:"content"}):(0,$.jsx)(b,{title:e.title,permissions:t})}}}]);
//# sourceMappingURL=8812.9011f52e.chunk.js.map